<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<body>

    <!--/* submenuLayout Fragment 정의 - layout.html에서 호출됨 */-->
    <div th:fragment="submenuLayout">
        
        <!-- Hero Section -->
        <section class="hero" th:if="${currentTopMenu != null}">
            <h1 th:text="${currentTopMenu.menuName}">메뉴 이름</h1>
            <div class="hero-illustration">
                <!-- Illustration would go here -->
            </div>
        </section>

        <!-- Breadcrumb (DB 기반 동적 생성) -->
        <section class="breadcrumb" th:if="${currentTopMenu != null}">
            <div class="container">
                <nav class="breadcrumb-nav">
                    <!-- 홈 링크 -->
                    <div class="breadcrumb-item" onclick="location.href='/'">
                        <span class="material-icons">home</span>
                    </div>
                    <span class="breadcrumb-separator">></span>
                    
                    <!-- 현재 최상위 메뉴 (드롭다운으로 모든 최상위 메뉴 표시) -->
                    <div class="breadcrumb-item dropdown">
                        <span th:text="${currentTopMenu.menuName}">메뉴</span>
                        <span class="material-icons">expand_more</span>
                        <div class="dropdown-menu" th:if="${allTopMenus != null}">
                            <!-- DB에서 가져온 모든 최상위 메뉴들을 동적으로 표시 -->
                            <a th:each="topMenu : ${allTopMenus}" 
                               th:href="${topMenu.path != null and !#strings.isEmpty(topMenu.path) ? topMenu.path : (topMenu.subMenus != null and !#lists.isEmpty(topMenu.subMenus) ? topMenu.subMenus[0].path : 'javascript:void(0);')}"
                               th:text="${topMenu.menuName}"
                               th:classappend="${topMenu.path == null and (#lists.isEmpty(topMenu.subMenus) or topMenu.subMenus[0].path == null) ? 'disabled' : ''}">메뉴</a>
                        </div>
                    </div>
                    
                    <!-- 현재 서브메뉴가 있는 경우에만 표시 (level 2 확인 및 active 서브메뉴 표시) -->
                    <th:block th:if="${currentSubMenus != null and !#lists.isEmpty(currentSubMenus)}">
                        <!-- active가 true인 서브메뉴 찾기 -->
                        <th:block th:with="activeSubMenu=${#lists.isEmpty(currentSubMenus) ? null : currentSubMenus.?[active == true][0]}">
                            <th:block th:if="${activeSubMenu != null and activeSubMenu.level == 2}">
                                <span class="breadcrumb-separator">></span>
                                <div class="breadcrumb-item dropdown">
                                    <!-- 현재 활성화된 서브메뉴 이름 표시 -->
                                    <span th:text="${activeSubMenu.menuName}">서브메뉴</span>
                                    <span class="material-icons">expand_more</span>
                                    <div class="dropdown-menu">
                                        <!-- 현재 최상위 메뉴의 모든 하위 메뉴들을 동적으로 표시 -->
                                        <a th:each="subMenu : ${currentSubMenus}" 
                                           th:href="${subMenu.path != null and !#strings.isEmpty(subMenu.path) ? subMenu.path : 'javascript:void(0);'}"
                                           th:text="${subMenu.menuName}"
                                           th:classappend="${(subMenu.path == null or #strings.isEmpty(subMenu.path) ? 'disabled' : '') + (subMenu.active ? ' active' : '')}">서브메뉴</a>
                                    </div>
                                </div>
                            </th:block>
                        </th:block>
                    </th:block>
                </nav>
            </div>
        </section>

        <!-- Main Content Area -->
        <main class="main-content">
            <!-- Sidebar -->
            <div th:replace="~{layout/sidebar :: sidebarFragment(mainMenuName=${currentMainMenuName}, subMenus=${currentSubMenus})}"></div>

            <!-- Page-specific Content -->
            <div class="content-area">
                <div layout:fragment="content">
                    <!-- 각 페이지의 콘텐츠가 이 부분에 삽입됩니다. -->
                </div>
            </div>
        </main>
    </div>
</body>
</html>