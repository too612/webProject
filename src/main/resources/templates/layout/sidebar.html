<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
    <!-- 
      개선된 사이드바:
      1. null 체크 강화
      2. active 상태를 MenuDto의 active 필드 사용
      3. 로그 정보 개선을 위한 디버그 정보 추가
    -->
    <aside class="sidebar" th:fragment="sidebarFragment(mainMenuName, subMenus)">
        <!-- 메인 메뉴명 표시 (null 체크 강화) -->
        <div class="sidebar-header" 
             th:text="${mainMenuName != null and !#strings.isEmpty(mainMenuName) ? mainMenuName : '메뉴'}">메뉴</div>
        
        <!-- 서브 메뉴 리스트 -->
        <ul class="sidebar-menu" th:if="${subMenus != null and !#lists.isEmpty(subMenus)}">
            <li th:each="subMenu : ${subMenus}" 
                th:if="${subMenu != null and subMenu.menuName != null}"
                th:classappend="${subMenu.active ? 'is-active' : ''}">
                <!-- 
                  링크 설정:
                  1. path가 있으면 해당 경로로 이동
                  2. path가 없으면 링크 비활성화
                -->
                <a th:href="${subMenu.path != null and !#strings.isEmpty(subMenu.path) ? subMenu.path : 'javascript:void(0);'}" 
                   th:text="${subMenu.menuName}"
                   th:classappend="${subMenu.path == null or #strings.isEmpty(subMenu.path) ? 'disabled' : ''}"
                   th:title="${subMenu.path != null ? subMenu.path : '링크가 설정되지 않음'}">서브메뉴</a>
            </li>
        </ul>
        
        <!-- 서브메뉴가 없는 경우 안내 메시지 (개발 단계에서 유용) -->
        <div th:unless="${subMenus != null and !#lists.isEmpty(subMenus)}" class="sidebar-empty">
            <p>하위 메뉴가 없습니다.</p>
        </div>
    </aside>

    <!-- CSS 스타일 추가 -->
    <style>
        .sidebar-menu li a.disabled {
            color: #999;
            cursor: default;
            text-decoration: none;
            pointer-events: none;
        }
        
        .sidebar-menu li.is-active a {
            font-weight: bold;
            color: #007bff;
            background-color: #f8f9fa;
        }
        
        .sidebar-empty {
            padding: 20px;
            text-align: center;
            color: #666;
            font-style: italic;
        }
        
        .sidebar-menu li a[title] {
            position: relative;
        }
        
        /* 툴팁 스타일 (선택사항) */
        .sidebar-menu li a:hover[title]:after {
            content: attr(title);
            position: absolute;
            left: 100%;
            top: 0;
            background: #333;
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            white-space: nowrap;
            z-index: 1000;
            font-size: 12px;
        }
    </style>
</body>
</html>